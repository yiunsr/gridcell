<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Hello World!</title>
    <link rel="stylesheet" type="text/css" href="../css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="../slickgrid/slick.grid.css">
		<link rel="stylesheet" type="text/css" href="../slickgrid/css/smoothness/jquery-ui-1.11.3.custom.css">
		<link rel="stylesheet" type="text/css" href="../slickgrid/examples/examples.css">
		<link rel="stylesheet" type="text/css" href="../css/grid.css">
		<style>
		html, body{font-size: 15px; }
		.grid-row-hader{
			border-right-color: silver;
      border-right-style: solid;
      background: #f5f5f5;
      color: gray;
      text-align: right;
      font-size: 10px;
		}
		</style>
  </head>
  <body>

		<div id="myGrid"></div>

		<!-- Modal -->
		<div class="modal fade" id="loadingModal" data-backdrop="static" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
			<div class="modal-dialog" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title" id="loadingModalTitle">Loading ... </h5>
					</div>
					<div class="modal-body">
						<div class="progress">
							<div id="loadingModalPercent" class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100" style="width: 75%">
							  0%
							</div>
						</div>
						<div class="row mt-2">
							<H4 class="col" id="loadingModalBody">
								loading
							</H4>
						</div>
					</div>
					<div class="modal-footer">
					</div>
				</div>
			</div>
		</div>

		

    <script>
    jQuery = window.$ = window.jQuery = require('jquery');
		require('../../renderer.js');
		const {ipcRenderer} = require('electron');
    </script>


	<script src="../js/bootstrap.min.js"> </script>
	<script src="../slickgrid/lib/jquery-ui-1.11.3.min.js"></script>
    <script src="../slickgrid/lib/jquery.event.drag-2.3.0.js"></script>
    <script src="../slickgrid/slick.core.js"></script>
	<script src="../slickgrid/slick.grid.js"></script>

	<script src="../slickgrid/plugins/slick.cellrangedecorator.js"></script>
	<script src="../slickgrid/plugins/slick.cellrangeselector.js"></script>
	<script src="../slickgrid/plugins/slick.cellselectionmodel.js"></script>
	<script src="../slickgrid/slick.formatters.js"></script>
	<script src="../slickgrid/slick.editors.js"></script>
	<script src="../slickgrid/slick.grid.js"></script>

	<script src="../js/util_render.js"></script>
	<script src="../js/util_ui.js"></script>

  <script>
	var start_time = new Date();
	var grid;
	var COL_COUNT = 20;

	var columns = [
		{id: "id", name: "id", field: "id"}
	];

	function initGrid(){
		var index = 0;

		columns = getColInfos(COL_COUNT);

		var options = {
			editable: true,
			enableAddRow: true,
			enableCellNavigation: true,
			enableColumnReorder: true,
			asyncEditorLoading: false,
			autoEdit: false,
			editCommandHandler: queueAndExecuteCommand
		};

		var data = [];
		for (var i = 0; i < 100000; i++) {
			var item = {id: i};
			for(index = 0; index < COL_COUNT; index++){
				var colname = getColName(index+1)
				item[colname] = i;
			}
			data.push(item);
		}
		var spend_time = ((new Date)-start_time) / 1000;
		console.log("data ready : " + spend_time);
		grid = new Slick.Grid("#myGrid", data, columns, options);
		spend_time = ((new Date)-start_time) / 1000;
		console.log("grid : " + spend_time);
	}
		
	
	var commandQueue = [];
	function queueAndExecuteCommand(item, column, editCommand) {
		commandQueue.push(editCommand);
		editCommand.execute();
	}

	function undo() {
		var command = commandQueue.pop();
		if (command && Slick.GlobalEditorLock.cancelCurrentEdit()) {
			command.undo();
			grid.gotoCell(command.row, command.cell, false);
		}
	}
	
	$(function(){
		initGrid();
	});
	
	ipcRenderer.on('api', (event, data) => {
      apiReceiver(data);
    })
	
	</script>
  </body>
</html>
